!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("neo4j-driver"),require("vis/dist/vis-network.min"),require("core-js/modules/es.symbol"),require("core-js/modules/es.symbol.description"),require("core-js/modules/es.symbol.iterator"),require("core-js/modules/es.array.iterator"),require("core-js/modules/es.object.define-property"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.string.iterator"),require("core-js/modules/web.dom-collections.iterator"),require("core-js/modules/es.array.concat"),require("core-js/modules/es.function.name"),require("core-js/modules/es.object.values"),require("core-js/modules/es.promise"),require("core-js/modules/web.timers"),require("regenerator-runtime/runtime"),require("vis/dist/vis-network.min.css")):"function"==typeof define&&define.amd?define(["neo4j-driver","vis/dist/vis-network.min","core-js/modules/es.symbol","core-js/modules/es.symbol.description","core-js/modules/es.symbol.iterator","core-js/modules/es.array.iterator","core-js/modules/es.object.define-property","core-js/modules/es.object.to-string","core-js/modules/es.string.iterator","core-js/modules/web.dom-collections.iterator","core-js/modules/es.array.concat","core-js/modules/es.function.name","core-js/modules/es.object.values","core-js/modules/es.promise","core-js/modules/web.timers","regenerator-runtime/runtime","vis/dist/vis-network.min.css"],r):"object"==typeof exports?exports.NeoVis=r(require("neo4j-driver"),require("vis/dist/vis-network.min"),require("core-js/modules/es.symbol"),require("core-js/modules/es.symbol.description"),require("core-js/modules/es.symbol.iterator"),require("core-js/modules/es.array.iterator"),require("core-js/modules/es.object.define-property"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.string.iterator"),require("core-js/modules/web.dom-collections.iterator"),require("core-js/modules/es.array.concat"),require("core-js/modules/es.function.name"),require("core-js/modules/es.object.values"),require("core-js/modules/es.promise"),require("core-js/modules/web.timers"),require("regenerator-runtime/runtime"),require("vis/dist/vis-network.min.css")):e.NeoVis=r(e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0])}(window,function(e,r,t,n,o,i,s,a,u,c,d,l,f,p,b,m,v){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=17)}([function(r,t){r.exports=e},function(e,t){e.exports=r},function(e,r){e.exports=t},function(e,r){e.exports=n},function(e,r){e.exports=o},function(e,r){e.exports=i},function(e,r){e.exports=s},function(e,r){e.exports=a},function(e,r){e.exports=u},function(e,r){e.exports=c},function(e,r){e.exports=d},function(e,r){e.exports=l},function(e,r){e.exports=f},function(e,r){e.exports=p},function(e,r){e.exports=b},function(e,r){e.exports=m},function(e,r){e.exports=v},function(e,r,t){"use strict";t.r(r);t(2),t(3),t(4),t(10),t(5),t(11),t(6),t(7),t(12),t(13),t(8),t(9),t(14),t(15);var n=t(0),o=t(1),i=(t(16),{neo4j:{initialQuery:"MATCH (n) WHERE exists(n.pagerank)\n                        WITH (n), RAND() AS random\n                        ORDER BY random LIMIT 3000\n                        OPTIONAL MATCH (n)-[r]-(m)\n                        //WITH n,r,m WHERE exists(n.pagerank) AND exists(m.pagerank) AND exists(m.community)\n                        RETURN n, r, m;",neo4jUri:"bolt://localhost:7687",neo4jUser:"neo4j",neo4jPassword:"neo4j",encrypted:"ENCRYPTION_OFF",trust:"TRUST_ALL_CERTIFICATES"},visjs:{interaction:{hover:!0,hoverConnectedEdges:!0,selectConnectedEdges:!1,multiselect:"alwaysOn",zoomView:!1,experimental:{}},physics:{barnesHut:{damping:.1}},nodes:{mass:4,shape:"neo",labelHighlightBold:!1,widthConstraint:{maximum:40},heightConstraint:{maximum:40}},edges:{hoverWidth:0,selectionWidth:0,smooth:{type:"continuous",roundness:.15},font:{size:9,strokeWidth:0,align:"top"},color:{inherit:!1},arrows:{to:{enabled:!0,type:"arrow",scaleFactor:.5}}}}});function s(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a="completed",u=function(){function e(){var r,t,n;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this._handlers=(n=[],(t=a)in(r={})?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r)}var r,t,n;return r=e,(t=[{key:"register",value:function(e,r){if(void 0===this._handlers[e])throw new Error("Unknown event: "+e);this._handlers[e].push(r)}},{key:"generateEvent",value:function(e,r){if(void 0===this._handlers[e])throw new Error("Unknown event: "+e);var t=!0,n=!1,o=void 0;try{for(var i,s=this._handlers[e][Symbol.iterator]();!(t=(i=s.next()).done);t=!0){(0,i.value)(r)}}catch(e){n=!0,o=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw o}}}}])&&s(r.prototype,t),n&&s(r,n),e}();function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,r,t,n,o,i,s){try{var a=e[i](s),u=a.value}catch(e){return void t(e)}a.done?r(u):Promise.resolve(u).then(n,o)}function l(e){return function(){var r=this,t=arguments;return new Promise(function(n,o){var i=e.apply(r,t);function s(e){d(i,n,o,s,a,"next",e)}function a(e){d(i,n,o,s,a,"throw",e)}s(void 0)})}}function f(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}t.d(r,"default",function(){return b});var b=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"_nodes",{}),p(this,"_edges",{}),p(this,"_data",{}),p(this,"_network",null),p(this,"_events",new u),this._init(r),this._debug(r),this._debug(i)}var r,t,s;return r=e,(t=[{key:"_debug",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log";this._config.debug_mode&&console[r](e)}},{key:"_init",value:function(e){this._config=e,this._encrypted=e.encrypted||i.neo4j.encrypted,this._trust=e.trust||i.neo4j.trust,this._driver=n.v1.driver(e.server_url||i.neo4j.neo4jUri,n.v1.auth.basic(e.server_user||i.neo4j.neo4jUser,e.server_password||i.neo4j.neo4jPassword),{encrypted:this._encrypted,trust:this._trust}),this._query=e.initial_cypher||i.neo4j.initialQuery,this._container=document.getElementById(e.container_id)}},{key:"_addNode",value:function(e){this._nodes[e.id]=e}},{key:"_addEdge",value:function(e){this._edges[e.id]=e}},{key:"buildNodeVisObject",value:function(){var e=l(regeneratorRuntime.mark(function e(r){var t,o,i,s,a,u,d,l,f,p,b,m,v,h,y,g,_,j,x,k,w,q,N;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},o=r.labels[0],i=this._config&&this._config.labels&&this._config.labels[o],s=i&&i.caption,a=i&&i.size,u=i&&i.sizeCypher,d=i&&i.community,t.id=r.identity.toInt(),!u){e.next=58;break}return l=this._driver.session(),e.next=12,l.run(u,{id:n.v1.int(t.id)});case 12:f=e.sent,p=!0,b=!1,m=void 0,e.prev=16,v=f.records[Symbol.iterator]();case 18:if(p=(h=v.next()).done){e.next=42;break}for(y=h.value,g=!0,_=!1,j=void 0,e.prev=23,x=y[Symbol.iterator]();!(g=(k=x.next()).done);g=!0)"number"==typeof(w=k.value)?this._addNode({id:t.id,value:w}):"Integer"===w.constructor.name&&this._addNode({id:t.id,value:w.toNumber()});e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),_=!0,j=e.t0;case 31:e.prev=31,e.prev=32,g||null==x.return||x.return();case 34:if(e.prev=34,!_){e.next=37;break}throw j;case 37:return e.finish(34);case 38:return e.finish(31);case 39:p=!0,e.next=18;break;case 42:e.next=48;break;case 44:e.prev=44,e.t1=e.catch(16),b=!0,m=e.t1;case 48:e.prev=48,e.prev=49,p||null==v.return||v.return();case 51:if(e.prev=51,!b){e.next=54;break}throw m;case 54:return e.finish(51);case 55:return e.finish(48);case 56:e.next=59;break;case 58:"number"==typeof a?t.value=a:(q=r.properties[a])&&"number"==typeof q?t.value=q:q&&"object"===c(q)&&"Integer"===q.constructor.name&&q.inSafeRange()?t.value=q.toNumber():t.value=1;case 59:if(t.label="function"==typeof s?s(r):r.properties[s]||o||"",d)try{r.properties[d]?t.group=r.properties[d].toNumber()||o||0:t.group=0}catch(e){t.group=0}else t.group=o;for(N in t.title="",r.properties)r.properties.hasOwnProperty(N)&&(t.title+="<strong>".concat(N,":</strong> ").concat(r.properties[N],"<br>"));return e.abrupt("return",t);case 64:case"end":return e.stop()}},e,this,[[16,44,48,56],[23,27,31,39],[32,,34,38],[49,,51,55]])}));return function(r){return e.apply(this,arguments)}}()},{key:"buildEdgeVisObject",value:function(e){var r=this._config&&this._config.relationships&&this._config.relationships[e.type],t=r&&r.thickness,n=r&&r.caption,o={};for(var i in o.id=e.identity.toInt(),o.from=e.start.toInt(),o.to=e.end.toInt(),o.title="",e.properties)e.properties.hasOwnProperty(i)&&(o.title+="<strong>".concat(i,":</strong> ").concat(e.properties[i],"<br>"));return o.value=t&&"string"==typeof t?e.properties[t]:t&&"number"==typeof t?t:1,o.label="boolean"==typeof n?n?e.type:"":n&&"string"==typeof n?e.properties[n]||"":e.type,o}},{key:"render",value:function(){var e=this,r=0,t=this._driver.session();t.run(this._query,{limit:30}).subscribe({onNext:function(){var t=l(regeneratorRuntime.mark(function t(n){var o,i,s,a,u,c,d,l,f,p,b,m,v,h,y,g,_,j,x,k,w,q,N,O;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r++,e._debug("CLASS NAME"),e._debug(n.constructor.name),e._debug(n),o=!0,i=!1,s=void 0,t.prev=7,a=n[Symbol.iterator]();case 9:if(o=(u=a.next()).done){t.next=111;break}if(c=u.value,e._debug("Constructor:"),e._debug(c.constructor.name),"Node"!==c.constructor.name){t.next=20;break}return t.next=16,e.buildNodeVisObject(c);case 16:d=t.sent;try{e._addNode(d)}catch(r){e._debug(r,"error")}t.next=108;break;case 20:if("Relationship"!==c.constructor.name){t.next=25;break}l=e.buildEdgeVisObject(c),e._addEdge(l),t.next=108;break;case 25:if("Path"!==c.constructor.name){t.next=73;break}return e._debug("PATH"),e._debug(c),t.next=30,e.buildNodeVisObject(c.start);case 30:return f=t.sent,t.next=33,e.buildNodeVisObject(c.end);case 33:p=t.sent,e._addNode(f),e._addNode(p),b=!0,m=!1,v=void 0,t.prev=39,h=c.segments[Symbol.iterator]();case 41:if(b=(y=h.next()).done){t.next=57;break}return g=y.value,t.t0=e,t.next=46,e.buildNodeVisObject(g.start);case 46:return t.t1=t.sent,t.t0._addNode.call(t.t0,t.t1),t.t2=e,t.next=51,e.buildNodeVisObject(g.end);case 51:t.t3=t.sent,t.t2._addNode.call(t.t2,t.t3),e._addEdge(e.buildEdgeVisObject(g.relationship));case 54:b=!0,t.next=41;break;case 57:t.next=63;break;case 59:t.prev=59,t.t4=t.catch(39),m=!0,v=t.t4;case 63:t.prev=63,t.prev=64,b||null==h.return||h.return();case 66:if(t.prev=66,!m){t.next=69;break}throw v;case 69:return t.finish(66);case 70:return t.finish(63);case 71:t.next=108;break;case 73:if("Array"!==c.constructor.name){t.next=108;break}_=!0,j=!1,x=void 0,t.prev=77,k=c[Symbol.iterator]();case 79:if(_=(w=k.next()).done){t.next=94;break}if(q=w.value,e._debug("Array element constructor:"),e._debug(q.constructor.name),"Node"!==q.constructor.name){t.next=90;break}return t.next=86,e.buildNodeVisObject(q);case 86:N=t.sent,e._addNode(N),t.next=91;break;case 90:"Relationship"===q.constructor.name&&(O=e.buildEdgeVisObject(q),e._addEdge(O));case 91:_=!0,t.next=79;break;case 94:t.next=100;break;case 96:t.prev=96,t.t5=t.catch(77),j=!0,x=t.t5;case 100:t.prev=100,t.prev=101,_||null==k.return||k.return();case 103:if(t.prev=103,!j){t.next=106;break}throw x;case 106:return t.finish(103);case 107:return t.finish(100);case 108:o=!0,t.next=9;break;case 111:t.next=117;break;case 113:t.prev=113,t.t6=t.catch(7),i=!0,s=t.t6;case 117:t.prev=117,t.prev=118,o||null==a.return||a.return();case 120:if(t.prev=120,!i){t.next=123;break}throw s;case 123:return t.finish(120);case 124:return t.finish(117);case 125:case"end":return t.stop()}},t,null,[[7,113,117,125],[39,59,63,71],[64,,66,70],[77,96,100,108],[101,,103,107],[118,,120,124]])}));return function(e){return t.apply(this,arguments)}}(),onCompleted:function(){t.close();var n={nodes:{shape:"dot",font:{size:26,strokeWidth:7},scaling:{label:{enabled:!0}}},edges:{arrows:{to:{enabled:e._config.arrows||!1}},length:200},layout:{improvedLayout:!1,hierarchical:{enabled:e._config.hierarchical||!1,sortMethod:e._config.hierarchical_sort_method||"hubsize"}},physics:{adaptiveTimestep:!0,stabilization:{iterations:200,fit:!0}}},i=e._container;e._data={nodes:new o.DataSet(Object.values(e._nodes)),edges:new o.DataSet(Object.values(e._edges))},e._debug(e._data.nodes),e._debug(e._data.edges),e._network=new o.Network(i,e._data,n),e._debug("completed"),setTimeout(function(){e._network.stopSimulation()},1e4),e._events.generateEvent(a,{record_count:r})},onError:function(r){e._debug(r)}})}},{key:"clearNetwork",value:function(){this._nodes={},this._edges={},this._network.setData([])}},{key:"registerOnEvent",value:function(e,r){this._events.register(e,r)}},{key:"reinit",value:function(e){this._init(e)}},{key:"reload",value:function(){this.clearNetwork(),this.render()}},{key:"stabilize",value:function(){this._network.stopSimulation(),this._debug("Calling stopSimulation")}},{key:"renderWithCypher",value:function(e){this.clearNetwork(),this._query=e,this.render()}}])&&f(r.prototype,t),s&&f(r,s),e}()}])});