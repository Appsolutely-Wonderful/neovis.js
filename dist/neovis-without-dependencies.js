!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("neo4j-driver"),require("vis/dist/vis-network.min"),require("core-js/modules/es.symbol"),require("core-js/modules/es.symbol.description"),require("core-js/modules/es.symbol.iterator"),require("core-js/modules/es.array.iterator"),require("core-js/modules/es.object.define-property"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.string.iterator"),require("core-js/modules/web.dom-collections.iterator"),require("core-js/modules/es.array.concat"),require("core-js/modules/es.array.map"),require("core-js/modules/es.function.name"),require("core-js/modules/es.object.values"),require("core-js/modules/es.promise"),require("core-js/modules/web.timers"),require("regenerator-runtime/runtime"),require("vis/dist/vis-network.min.css")):"function"==typeof define&&define.amd?define(["neo4j-driver","vis/dist/vis-network.min","core-js/modules/es.symbol","core-js/modules/es.symbol.description","core-js/modules/es.symbol.iterator","core-js/modules/es.array.iterator","core-js/modules/es.object.define-property","core-js/modules/es.object.to-string","core-js/modules/es.string.iterator","core-js/modules/web.dom-collections.iterator","core-js/modules/es.array.concat","core-js/modules/es.array.map","core-js/modules/es.function.name","core-js/modules/es.object.values","core-js/modules/es.promise","core-js/modules/web.timers","regenerator-runtime/runtime","vis/dist/vis-network.min.css"],r):"object"==typeof exports?exports.NeoVis=r(require("neo4j-driver"),require("vis/dist/vis-network.min"),require("core-js/modules/es.symbol"),require("core-js/modules/es.symbol.description"),require("core-js/modules/es.symbol.iterator"),require("core-js/modules/es.array.iterator"),require("core-js/modules/es.object.define-property"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.string.iterator"),require("core-js/modules/web.dom-collections.iterator"),require("core-js/modules/es.array.concat"),require("core-js/modules/es.array.map"),require("core-js/modules/es.function.name"),require("core-js/modules/es.object.values"),require("core-js/modules/es.promise"),require("core-js/modules/web.timers"),require("regenerator-runtime/runtime"),require("vis/dist/vis-network.min.css")):e.NeoVis=r(e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0],e[void 0])}(window,function(e,r,t,o,n,s,i,a,c,u,l,d,p,f,m,v,b,h){return function(e){var r={};function t(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=r,t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)t.d(o,n,function(r){return e[r]}.bind(null,n));return o},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=18)}([function(r,t){r.exports=e},function(e,t){e.exports=r},function(e,r){e.exports=t},function(e,r){e.exports=o},function(e,r){e.exports=n},function(e,r){e.exports=s},function(e,r){e.exports=i},function(e,r){e.exports=a},function(e,r){e.exports=c},function(e,r){e.exports=u},function(e,r){e.exports=l},function(e,r){e.exports=d},function(e,r){e.exports=p},function(e,r){e.exports=f},function(e,r){e.exports=m},function(e,r){e.exports=v},function(e,r){e.exports=b},function(e,r){e.exports=h},function(e,r,t){"use strict";t.r(r);t(2),t(3),t(4),t(10),t(5),t(11),t(12),t(6),t(7),t(13),t(14),t(8),t(9),t(15),t(16);var o=t(0),n=t(1),s=(t(17),{neo4j:{initialQuery:"MATCH (n) WHERE exists(n.pagerank)\n                        WITH (n), RAND() AS random\n                        ORDER BY random LIMIT 3000\n                        OPTIONAL MATCH (n)-[r]-(m)\n                        //WITH n,r,m WHERE exists(n.pagerank) AND exists(m.pagerank) AND exists(m.community)\n                        RETURN n, r, m;",neo4jUri:"bolt://localhost:7687",neo4jUser:"neo4j",neo4jPassword:"neo4j",encrypted:"ENCRYPTION_OFF",trust:"TRUST_ALL_CERTIFICATES"},visjs:{interaction:{hover:!0,hoverConnectedEdges:!0,selectConnectedEdges:!1,multiselect:"alwaysOn",zoomView:!1,experimental:{}},physics:{barnesHut:{damping:.1}},nodes:{mass:4,shape:"neo",labelHighlightBold:!1,widthConstraint:{maximum:40},heightConstraint:{maximum:40}},edges:{hoverWidth:0,selectionWidth:0,smooth:{type:"continuous",roundness:.15},font:{size:9,strokeWidth:0,align:"top"},color:{inherit:!1},arrows:{to:{enabled:!0,type:"arrow",scaleFactor:.5}}}}});function i(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a="completed",c=function(){function e(){var r,t,o;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this._handlers=(o=[],(t=a)in(r={})?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r)}var r,t,o;return r=e,(t=[{key:"register",value:function(e,r){if(void 0===this._handlers[e])throw new Error("Unknown event: "+e);this._handlers[e].push(r)}},{key:"generateEvent",value:function(e,r){if(void 0===this._handlers[e])throw new Error("Unknown event: "+e);var t=!0,o=!1,n=void 0;try{for(var s,i=this._handlers[e][Symbol.iterator]();!(t=(s=i.next()).done);t=!0){(0,s.value)(r)}}catch(e){o=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(o)throw n}}}}])&&i(r.prototype,t),o&&i(r,o),e}();function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,r,t,o,n,s,i){try{var a=e[s](i),c=a.value}catch(e){return void t(e)}a.done?r(c):Promise.resolve(c).then(o,n)}function d(e){return function(){var r=this,t=arguments;return new Promise(function(o,n){var s=e.apply(r,t);function i(e){l(s,o,n,i,a,"next",e)}function a(e){l(s,o,n,i,a,"throw",e)}i(void 0)})}}function p(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}t.d(r,"default",function(){return m});var m=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"_nodes",{}),f(this,"_edges",{}),f(this,"_data",{}),f(this,"_network",null),f(this,"_events",new c),this._init(r),this._consoleLog(r),this._consoleLog(s)}var r,t,i;return r=e,(t=[{key:"_consoleLog",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log";this._config.console_debug&&console[r](e)}},{key:"_init",value:function(e){this._config=e,this._encrypted=e.encrypted||s.neo4j.encrypted,this._trust=e.trust||s.neo4j.trust,this._driver=o.v1.driver(e.server_url||s.neo4j.neo4jUri,o.v1.auth.basic(e.server_user||s.neo4j.neo4jUser,e.server_password||s.neo4j.neo4jPassword),{encrypted:this._encrypted,trust:this._trust}),this._query=e.initial_cypher||s.neo4j.initialQuery,this._container=document.getElementById(e.container_id)}},{key:"_addNode",value:function(e){this._nodes[e.id]=e}},{key:"_addEdge",value:function(e){this._edges[e.id]=e}},{key:"buildNodeVisObject",value:function(){var e=d(regeneratorRuntime.mark(function e(r){var t,n,s,i,a,c,l,d,p,f,m,v,b,h,y,g,j,_,x,k,w,q,O;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},n=r.labels[0],s=this._config&&this._config.labels&&this._config.labels[n],i=s&&s.caption,a=s&&s.size,c=s&&s.sizeCypher,l=s&&s.community,t.id=r.identity.toInt(),!c){e.next=58;break}return d=this._driver.session(),e.next=12,d.run(c,{id:o.v1.int(t.id)});case 12:p=e.sent,f=!0,m=!1,v=void 0,e.prev=16,b=p.records[Symbol.iterator]();case 18:if(f=(h=b.next()).done){e.next=42;break}for(y=h.value,g=!0,j=!1,_=void 0,e.prev=23,x=y[Symbol.iterator]();!(g=(k=x.next()).done);g=!0)"number"==typeof(w=k.value)?t.value=w:"Integer"===w.constructor.name&&(t.value=w.toNumber());e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),j=!0,_=e.t0;case 31:e.prev=31,e.prev=32,g||null==x.return||x.return();case 34:if(e.prev=34,!j){e.next=37;break}throw _;case 37:return e.finish(34);case 38:return e.finish(31);case 39:f=!0,e.next=18;break;case 42:e.next=48;break;case 44:e.prev=44,e.t1=e.catch(16),m=!0,v=e.t1;case 48:e.prev=48,e.prev=49,f||null==b.return||b.return();case 51:if(e.prev=51,!m){e.next=54;break}throw v;case 54:return e.finish(51);case 55:return e.finish(48);case 56:e.next=59;break;case 58:"number"==typeof a?t.value=a:(q=r.properties[a])&&"number"==typeof q?t.value=q:q&&"object"===u(q)&&"Integer"===q.constructor.name&&q.inSafeRange()?t.value=q.toNumber():t.value=1;case 59:if(t.label="function"==typeof i?i(r):r.properties[i]||n||"",l)try{r.properties[l]?t.group=r.properties[l].toNumber()||n||0:t.group=0}catch(e){t.group=0}else t.group=n;for(O in t.title="",r.properties)r.properties.hasOwnProperty(O)&&(t.title+="<strong>".concat(O,":</strong> ").concat(r.properties[O],"<br>"));return e.abrupt("return",t);case 64:case"end":return e.stop()}},e,this,[[16,44,48,56],[23,27,31,39],[32,,34,38],[49,,51,55]])}));return function(r){return e.apply(this,arguments)}}()},{key:"buildEdgeVisObject",value:function(e){var r=this._config&&this._config.relationships&&this._config.relationships[e.type],t=r&&r.thickness,o=r&&r.caption,n={};for(var s in n.id=e.identity.toInt(),n.from=e.start.toInt(),n.to=e.end.toInt(),n.title="",e.properties)e.properties.hasOwnProperty(s)&&(n.title+="<strong>".concat(s,":</strong> ").concat(e.properties[s],"<br>"));return n.value=t&&"string"==typeof t?e.properties[t]:t&&"number"==typeof t?t:1,n.label="boolean"==typeof o?o?e.type:"":o&&"string"==typeof o?e.properties[o]||"":e.type,n}},{key:"render",value:function(){var e=this,r=0,t=this._driver.session(),o=[];t.run(this._query,{limit:30}).subscribe({onNext:function(t){r++,e._consoleLog("CLASS NAME"),e._consoleLog(t.constructor.name),e._consoleLog(t);var n=Object.values(t.toObject()).map(function(){var r=d(regeneratorRuntime.mark(function r(t){var o,n,s,i,a,c,u,l,d,p,f,m,v,b,h,y,g,j;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e._consoleLog("Constructor:"),e._consoleLog(t.constructor.name),"Node"!==t.constructor.name){r.next=9;break}return r.next=5,e.buildNodeVisObject(t);case 5:o=r.sent;try{e._addNode(o)}catch(r){e._consoleLog(r,"error")}r.next=97;break;case 9:if("Relationship"!==t.constructor.name){r.next=14;break}n=e.buildEdgeVisObject(t),e._addEdge(n),r.next=97;break;case 14:if("Path"!==t.constructor.name){r.next=62;break}return e._consoleLog("PATH"),e._consoleLog(t),r.next=19,e.buildNodeVisObject(t.start);case 19:return s=r.sent,r.next=22,e.buildNodeVisObject(t.end);case 22:i=r.sent,e._addNode(s),e._addNode(i),a=!0,c=!1,u=void 0,r.prev=28,l=t.segments[Symbol.iterator]();case 30:if(a=(d=l.next()).done){r.next=46;break}return p=d.value,r.t0=e,r.next=35,e.buildNodeVisObject(p.start);case 35:return r.t1=r.sent,r.t0._addNode.call(r.t0,r.t1),r.t2=e,r.next=40,e.buildNodeVisObject(p.end);case 40:r.t3=r.sent,r.t2._addNode.call(r.t2,r.t3),e._addEdge(e.buildEdgeVisObject(p.relationship));case 43:a=!0,r.next=30;break;case 46:r.next=52;break;case 48:r.prev=48,r.t4=r.catch(28),c=!0,u=r.t4;case 52:r.prev=52,r.prev=53,a||null==l.return||l.return();case 55:if(r.prev=55,!c){r.next=58;break}throw u;case 58:return r.finish(55);case 59:return r.finish(52);case 60:r.next=97;break;case 62:if("Array"!==t.constructor.name){r.next=97;break}f=!0,m=!1,v=void 0,r.prev=66,b=t[Symbol.iterator]();case 68:if(f=(h=b.next()).done){r.next=83;break}if(y=h.value,e._consoleLog("Array element constructor:"),e._consoleLog(y.constructor.name),"Node"!==y.constructor.name){r.next=79;break}return r.next=75,e.buildNodeVisObject(y);case 75:g=r.sent,e._addNode(g),r.next=80;break;case 79:"Relationship"===y.constructor.name&&(j=e.buildEdgeVisObject(y),e._addEdge(j));case 80:f=!0,r.next=68;break;case 83:r.next=89;break;case 85:r.prev=85,r.t5=r.catch(66),m=!0,v=r.t5;case 89:r.prev=89,r.prev=90,f||null==b.return||b.return();case 92:if(r.prev=92,!m){r.next=95;break}throw v;case 95:return r.finish(92);case 96:return r.finish(89);case 97:case"end":return r.stop()}},r,null,[[28,48,52,60],[53,,55,59],[66,85,89,97],[90,,92,96]])}));return function(e){return r.apply(this,arguments)}}());o.push(Promise.all(n))},onCompleted:function(){var s=d(regeneratorRuntime.mark(function s(){var i,c;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Promise.all(o);case 2:t.close(),i={nodes:{shape:"dot",font:{size:26,strokeWidth:7},scaling:{label:{enabled:!0}}},edges:{arrows:{to:{enabled:e._config.arrows||!1}},length:200},layout:{improvedLayout:!1,hierarchical:{enabled:e._config.hierarchical||!1,sortMethod:e._config.hierarchical_sort_method||"hubsize"}},physics:{adaptiveTimestep:!0,stabilization:{iterations:200,fit:!0}}},c=e._container,e._data={nodes:new n.DataSet(Object.values(e._nodes)),edges:new n.DataSet(Object.values(e._edges))},e._consoleLog(e._data.nodes),e._consoleLog(e._data.edges),e._network=new n.Network(c,e._data,i),e._consoleLog("completed"),setTimeout(function(){e._network.stopSimulation()},1e4),e._events.generateEvent(a,{record_count:r});case 12:case"end":return s.stop()}},s)}));return function(){return s.apply(this,arguments)}}(),onError:function(r){e._consoleLog(r)}})}},{key:"clearNetwork",value:function(){this._nodes={},this._edges={},this._network.setData([])}},{key:"registerOnEvent",value:function(e,r){this._events.register(e,r)}},{key:"reinit",value:function(e){this._init(e),this.render()}},{key:"reload",value:function(){this.clearNetwork(),this.render()}},{key:"stabilize",value:function(){this._network.stopSimulation(),this._consoleLog("Calling stopSimulation")}},{key:"renderWithCypher",value:function(e){this.clearNetwork(),this._query=e,this.render()}}])&&p(r.prototype,t),i&&p(r,i),e}()}])});